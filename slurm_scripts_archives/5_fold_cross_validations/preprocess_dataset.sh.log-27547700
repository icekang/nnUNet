Fingerprint extraction...
Dataset307_Sohee_Calcium_OCT_CrossValidation
Using <class 'nnunetv2.imageio.simpleitk_reader_writer.SimpleITKIO'> as reader/writer

####################
verify_dataset_integrity Done. 
If you didn't see any error messages then your dataset is most likely OK!
####################

Using <class 'nnunetv2.imageio.simpleitk_reader_writer.SimpleITKIO'> as reader/writer
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:08<00:59,  8.52s/it] 25%|██▌       | 2/8 [00:08<00:21,  3.63s/it] 38%|███▊      | 3/8 [00:08<00:10,  2.02s/it] 50%|█████     | 4/8 [00:09<00:05,  1.30s/it] 62%|██████▎   | 5/8 [00:09<00:02,  1.15it/s] 75%|███████▌  | 6/8 [00:09<00:01,  1.56it/s] 88%|████████▊ | 7/8 [00:09<00:00,  2.14it/s]100%|██████████| 8/8 [00:10<00:00,  1.74it/s]100%|██████████| 8/8 [00:10<00:00,  1.29s/it]
Experiment planning...

############################
INFO: You are using the old nnU-Net default planner. We have updated our recommendations. Please consider using those instead! Read more here: https://github.com/MIC-DKFZ/nnUNet/blob/master/documentation/resenc_presets.md
############################

Attempting to find 3d_lowres config. 
Current spacing: [1.03 1.03 1.03]. 
Current patch size: (112, 160, 128). 
Current median shape: [364.0776699  483.49514563 483.49514563]
Attempting to find 3d_lowres config. 
Current spacing: [1.0609 1.0609 1.0609]. 
Current patch size: (112, 160, 128). 
Current median shape: [353.47346593 469.41276275 469.41276275]
Attempting to find 3d_lowres config. 
Current spacing: [1.092727 1.092727 1.092727]. 
Current patch size: (112, 160, 128). 
Current median shape: [343.17812226 455.74054636 455.74054636]
Attempting to find 3d_lowres config. 
Current spacing: [1.12550881 1.12550881 1.12550881]. 
Current patch size: (112, 160, 128). 
Current median shape: [333.18264297 442.46654986 442.46654986]
Attempting to find 3d_lowres config. 
Current spacing: [1.15927407 1.15927407 1.15927407]. 
Current patch size: (112, 160, 128). 
Current median shape: [323.47829414 429.57917462 429.57917462]
Attempting to find 3d_lowres config. 
Current spacing: [1.1940523 1.1940523 1.1940523]. 
Current patch size: (112, 160, 128). 
Current median shape: [314.05659626 417.06715983 417.06715983]
Attempting to find 3d_lowres config. 
Current spacing: [1.22987387 1.22987387 1.22987387]. 
Current patch size: (112, 160, 128). 
Current median shape: [304.90931675 404.91957265 404.91957265]
Attempting to find 3d_lowres config. 
Current spacing: [1.26677008 1.26677008 1.26677008]. 
Current patch size: (112, 160, 128). 
Current median shape: [296.02846287 393.12579869 393.12579869]
Attempting to find 3d_lowres config. 
Current spacing: [1.30477318 1.30477318 1.30477318]. 
Current patch size: (112, 160, 128). 
Current median shape: [287.40627463 381.67553271 381.67553271]
Attempting to find 3d_lowres config. 
Current spacing: [1.34391638 1.34391638 1.34391638]. 
Current patch size: (112, 160, 128). 
Current median shape: [279.03521809 370.55876962 370.55876962]
Attempting to find 3d_lowres config. 
Current spacing: [1.38423387 1.38423387 1.38423387]. 
Current patch size: (112, 160, 128). 
Current median shape: [270.90797872 359.76579575 359.76579575]
Attempting to find 3d_lowres config. 
Current spacing: [1.42576089 1.42576089 1.42576089]. 
Current patch size: (112, 160, 128). 
Current median shape: [263.01745507 349.28718034 349.28718034]
Attempting to find 3d_lowres config. 
Current spacing: [1.46853371 1.46853371 1.46853371]. 
Current patch size: (112, 160, 128). 
Current median shape: [255.3567525  339.11376732 339.11376732]
Attempting to find 3d_lowres config. 
Current spacing: [1.51258972 1.51258972 1.51258972]. 
Current patch size: (112, 160, 128). 
Current median shape: [247.91917718 329.2366673  329.2366673 ]
Attempting to find 3d_lowres config. 
Current spacing: [1.55796742 1.55796742 1.55796742]. 
Current patch size: (112, 160, 128). 
Current median shape: [240.69823027 319.6472498  319.6472498 ]
Attempting to find 3d_lowres config. 
Current spacing: [1.60470644 1.60470644 1.60470644]. 
Current patch size: (112, 160, 128). 
Current median shape: [233.68760221 310.33713573 310.33713573]
Attempting to find 3d_lowres config. 
Current spacing: [1.65284763 1.65284763 1.65284763]. 
Current patch size: (112, 160, 128). 
Current median shape: [226.88116719 301.29819003 301.29819003]
Attempting to find 3d_lowres config. 
Current spacing: [1.70243306 1.70243306 1.70243306]. 
Current patch size: (112, 160, 128). 
Current median shape: [220.27297786 292.52251459 292.52251459]
Attempting to find 3d_lowres config. 
Current spacing: [1.75350605 1.75350605 1.75350605]. 
Current patch size: (112, 160, 128). 
Current median shape: [213.85726005 284.00244135 284.00244135]
Attempting to find 3d_lowres config. 
Current spacing: [1.80611123 1.80611123 1.80611123]. 
Current patch size: (112, 160, 128). 
Current median shape: [207.62840782 275.73052558 275.73052558]
Attempting to find 3d_lowres config. 
Current spacing: [1.86029457 1.86029457 1.86029457]. 
Current patch size: (112, 160, 128). 
Current median shape: [201.58097847 267.6995394  267.6995394 ]
Attempting to find 3d_lowres config. 
Current spacing: [1.91610341 1.91610341 1.91610341]. 
Current patch size: (112, 160, 128). 
Current median shape: [195.70968783 259.90246544 259.90246544]
Attempting to find 3d_lowres config. 
Current spacing: [1.97358651 1.97358651 1.97358651]. 
Current patch size: (112, 160, 128). 
Current median shape: [190.00940566 252.33249072 252.33249072]
Attempting to find 3d_lowres config. 
Current spacing: [2.03279411 2.03279411 2.03279411]. 
Current patch size: (112, 160, 128). 
Current median shape: [184.47515113 244.9830007  244.9830007 ]
Attempting to find 3d_lowres config. 
Current spacing: [2.09377793 2.09377793 2.09377793]. 
Current patch size: (112, 160, 128). 
Current median shape: [179.10208847 237.84757349 237.84757349]
Attempting to find 3d_lowres config. 
Current spacing: [2.15659127 2.15659127 2.15659127]. 
Current patch size: (112, 160, 128). 
Current median shape: [173.88552279 230.91997426 230.91997426]
Attempting to find 3d_lowres config. 
Current spacing: [2.22128901 2.22128901 2.22128901]. 
Current patch size: (112, 160, 128). 
Current median shape: [168.82089591 224.19414977 224.19414977]
2D U-Net configuration:
{'data_identifier': 'nnUNetPlans_2d', 'preprocessor_name': 'DefaultPreprocessor', 'batch_size': 12, 'patch_size': (512, 512), 'median_image_size_in_voxels': array([498., 498.]), 'spacing': array([1., 1.]), 'normalization_schemes': ['ZScoreNormalization'], 'use_mask_for_norm': [False], 'resampling_fn_data': 'resample_data_or_seg_to_shape', 'resampling_fn_seg': 'resample_data_or_seg_to_shape', 'resampling_fn_data_kwargs': {'is_seg': False, 'order': 3, 'order_z': 0, 'force_separate_z': None}, 'resampling_fn_seg_kwargs': {'is_seg': True, 'order': 1, 'order_z': 0, 'force_separate_z': None}, 'resampling_fn_probabilities': 'resample_data_or_seg_to_shape', 'resampling_fn_probabilities_kwargs': {'is_seg': False, 'order': 1, 'order_z': 0, 'force_separate_z': None}, 'architecture': {'network_class_name': 'dynamic_network_architectures.architectures.unet.PlainConvUNet', 'arch_kwargs': {'n_stages': 8, 'features_per_stage': (32, 64, 128, 256, 512, 512, 512, 512), 'conv_op': 'torch.nn.modules.conv.Conv2d', 'kernel_sizes': ((3, 3), (3, 3), (3, 3), (3, 3), (3, 3), (3, 3), (3, 3), (3, 3)), 'strides': ((1, 1), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)), 'n_conv_per_stage': (2, 2, 2, 2, 2, 2, 2, 2), 'n_conv_per_stage_decoder': (2, 2, 2, 2, 2, 2, 2), 'conv_bias': True, 'norm_op': 'torch.nn.modules.instancenorm.InstanceNorm2d', 'norm_op_kwargs': {'eps': 1e-05, 'affine': True}, 'dropout_op': None, 'dropout_op_kwargs': None, 'nonlin': 'torch.nn.LeakyReLU', 'nonlin_kwargs': {'inplace': True}}, '_kw_requires_import': ('conv_op', 'norm_op', 'dropout_op', 'nonlin')}, 'batch_dice': True}

Using <class 'nnunetv2.imageio.simpleitk_reader_writer.SimpleITKIO'> as reader/writer
3D lowres U-Net configuration:
{'data_identifier': 'nnUNetPlans_3d_lowres', 'preprocessor_name': 'DefaultPreprocessor', 'batch_size': 2, 'patch_size': (112, 160, 128), 'median_image_size_in_voxels': (169, 224, 224), 'spacing': array([2.22128901, 2.22128901, 2.22128901]), 'normalization_schemes': ['ZScoreNormalization'], 'use_mask_for_norm': [False], 'resampling_fn_data': 'resample_data_or_seg_to_shape', 'resampling_fn_seg': 'resample_data_or_seg_to_shape', 'resampling_fn_data_kwargs': {'is_seg': False, 'order': 3, 'order_z': 0, 'force_separate_z': None}, 'resampling_fn_seg_kwargs': {'is_seg': True, 'order': 1, 'order_z': 0, 'force_separate_z': None}, 'resampling_fn_probabilities': 'resample_data_or_seg_to_shape', 'resampling_fn_probabilities_kwargs': {'is_seg': False, 'order': 1, 'order_z': 0, 'force_separate_z': None}, 'architecture': {'network_class_name': 'dynamic_network_architectures.architectures.unet.PlainConvUNet', 'arch_kwargs': {'n_stages': 6, 'features_per_stage': (32, 64, 128, 256, 320, 320), 'conv_op': 'torch.nn.modules.conv.Conv3d', 'kernel_sizes': ((3, 3, 3), (3, 3, 3), (3, 3, 3), (3, 3, 3), (3, 3, 3), (3, 3, 3)), 'strides': ((1, 1, 1), (2, 2, 2), (2, 2, 2), (2, 2, 2), (2, 2, 2), (1, 2, 2)), 'n_conv_per_stage': (2, 2, 2, 2, 2, 2), 'n_conv_per_stage_decoder': (2, 2, 2, 2, 2), 'conv_bias': True, 'norm_op': 'torch.nn.modules.instancenorm.InstanceNorm3d', 'norm_op_kwargs': {'eps': 1e-05, 'affine': True}, 'dropout_op': None, 'dropout_op_kwargs': None, 'nonlin': 'torch.nn.LeakyReLU', 'nonlin_kwargs': {'inplace': True}}, '_kw_requires_import': ('conv_op', 'norm_op', 'dropout_op', 'nonlin')}, 'batch_dice': False, 'next_stage': '3d_cascade_fullres'}

3D fullres U-Net configuration:
{'data_identifier': 'nnUNetPlans_3d_fullres', 'preprocessor_name': 'DefaultPreprocessor', 'batch_size': 2, 'patch_size': (112, 160, 128), 'median_image_size_in_voxels': array([375., 498., 498.]), 'spacing': array([1., 1., 1.]), 'normalization_schemes': ['ZScoreNormalization'], 'use_mask_for_norm': [False], 'resampling_fn_data': 'resample_data_or_seg_to_shape', 'resampling_fn_seg': 'resample_data_or_seg_to_shape', 'resampling_fn_data_kwargs': {'is_seg': False, 'order': 3, 'order_z': 0, 'force_separate_z': None}, 'resampling_fn_seg_kwargs': {'is_seg': True, 'order': 1, 'order_z': 0, 'force_separate_z': None}, 'resampling_fn_probabilities': 'resample_data_or_seg_to_shape', 'resampling_fn_probabilities_kwargs': {'is_seg': False, 'order': 1, 'order_z': 0, 'force_separate_z': None}, 'architecture': {'network_class_name': 'dynamic_network_architectures.architectures.unet.PlainConvUNet', 'arch_kwargs': {'n_stages': 6, 'features_per_stage': (32, 64, 128, 256, 320, 320), 'conv_op': 'torch.nn.modules.conv.Conv3d', 'kernel_sizes': ((3, 3, 3), (3, 3, 3), (3, 3, 3), (3, 3, 3), (3, 3, 3), (3, 3, 3)), 'strides': ((1, 1, 1), (2, 2, 2), (2, 2, 2), (2, 2, 2), (2, 2, 2), (1, 2, 2)), 'n_conv_per_stage': (2, 2, 2, 2, 2, 2), 'n_conv_per_stage_decoder': (2, 2, 2, 2, 2), 'conv_bias': True, 'norm_op': 'torch.nn.modules.instancenorm.InstanceNorm3d', 'norm_op_kwargs': {'eps': 1e-05, 'affine': True}, 'dropout_op': None, 'dropout_op_kwargs': None, 'nonlin': 'torch.nn.LeakyReLU', 'nonlin_kwargs': {'inplace': True}}, '_kw_requires_import': ('conv_op', 'norm_op', 'dropout_op', 'nonlin')}, 'batch_dice': True}

Plans were saved to /home/gridsan/nchutisilp/datasets/nnUNet_Datasets/nnUNet_preprocessed/Dataset307_Sohee_Calcium_OCT_CrossValidation/nnUNetPlans.json
Preprocessing...
Preprocessing dataset Dataset307_Sohee_Calcium_OCT_CrossValidation
Configuration: 2d...
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:23<02:44, 23.54s/it] 25%|██▌       | 2/8 [00:24<01:01, 10.22s/it] 38%|███▊      | 3/8 [00:24<00:28,  5.60s/it] 50%|█████     | 4/8 [00:24<00:13,  3.43s/it] 62%|██████▎   | 5/8 [00:25<00:07,  2.48s/it] 75%|███████▌  | 6/8 [00:25<00:03,  1.67s/it] 88%|████████▊ | 7/8 [00:27<00:01,  1.78s/it]100%|██████████| 8/8 [00:33<00:00,  3.03s/it]100%|██████████| 8/8 [00:33<00:00,  4.17s/it]
Configuration: 3d_fullres...
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:22<02:40, 22.93s/it] 25%|██▌       | 2/8 [00:24<01:01, 10.21s/it] 38%|███▊      | 3/8 [00:27<00:34,  6.87s/it] 50%|█████     | 4/8 [00:32<00:25,  6.42s/it] 62%|██████▎   | 5/8 [00:44<00:25,  8.47s/it] 75%|███████▌  | 6/8 [00:45<00:11,  5.83s/it] 88%|████████▊ | 7/8 [00:48<00:04,  4.74s/it]100%|██████████| 8/8 [00:54<00:00,  5.40s/it]100%|██████████| 8/8 [00:55<00:00,  6.89s/it]
Configuration: 3d_lowres...
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:25<03:00, 25.74s/it] 25%|██▌       | 2/8 [00:25<01:03, 10.66s/it] 50%|█████     | 4/8 [00:26<00:16,  4.04s/it] 62%|██████▎   | 5/8 [00:26<00:08,  2.82s/it] 88%|████████▊ | 7/8 [00:27<00:01,  1.78s/it]100%|██████████| 8/8 [00:43<00:00,  5.38s/it]100%|██████████| 8/8 [00:43<00:00,  5.45s/it]
